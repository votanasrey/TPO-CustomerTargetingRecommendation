WITH DIS AS(
SELECT
	-- Agent Info
	[DepoCode]
	,[Name] AS Agent_Name
	-- Customer Info
    ,[Sell-to Customer No_] AS Outlet_Code
    ,[Sell-to Customer Name] AS Outlet_Name
	,[OutletCode]
    ,[OutletNameKh]
    ,[OutletNameEn]
    ,[Region]
    ,[Province]
    ,[Account_Type]
	,[City]
    ,[District]
    ,[Commune]
    ,[Village]
	,[Segment]
    ,[Business_Org_Segment]
    ,[Business_Segment]
    ,[Category]
	,[ChannelName]
    ,[OutletCreditStatus]
    ,[Sell-to Address]
    ,[Invoice Remarks]
    ,[OrderType]
    ,[Document No_]
	,[DocType]
	,[ContractType]
    ,[OrderCategory]
    ,[ItemCode]
    ,[Quantity]
    ,[HL]
    ,[amount1]
    ,[Amount Including VAT]
    ,[itm_code]
    ,[itm_des]
    ,[level1_territory and Name]
    ,[level2_territory and Name]
    ,[level3_territory and Name]
    ,[level4_territory and Name]
	,[Order Date]
    ,[Posting Date]
    ,[Shipment Date]
    ,[Posting Description]
    ,[Due Date]
    ,[Document Date]
FROM [DWH_HCAM].[dbo].[V_F_DIS_BI]
WHERE itm_code IN ('10000358', '10003656', '10003660', '10004510')
AND [Posting Date] BETWEEN '2023-02-01 00:00:00.000' AND '2023-03-31 00:00:00.000' 

), MASTER_DATA AS(
SELECT 
	  [Code]
	  ,Grade
	  ,Status
	  ,Cluster_Lead
	  ,[OUTLET_LATITUDE]
      ,[OUTLET_LONGITUDE]
	  ,[AMS_HCAM_Premium_Brand]
      ,[AMS_HCAM_Mainstream_Brand]
      ,[AMS_Competitors_Premium_Brand]
      ,[AMS_Competitors_Mainstream_Brand]
FROM [OutletMasterSEM].[dbo].[v_Outlet_Master_Data]
), RESULT_TABLE AS(
SELECT 
	-- Agent Info
	A.[DepoCode] AS Agent_Code
	,A.Agent_Name
	-- Customer Info
    ,A.Outlet_Code
    ,A.Outlet_Name
    ,A.[OutletNameEn]
    ,A.[Region]
    ,A.[Province]
    ,A.[Account_Type]
	,B.Status 
	,B.Grade
	,A.[City]
    ,A.[District]
    ,A.[Commune]
    ,A.[Village]
	,B.Cluster_Lead
	,A.[Segment]
    ,A.[Business_Org_Segment]
    ,A.[Business_Segment]
    ,A.[Category]
	,A.[ChannelName]
    ,A.[OutletCreditStatus]
	,B.[AMS_HCAM_Premium_Brand]
    ,B.[AMS_HCAM_Mainstream_Brand]
    ,B.[AMS_Competitors_Premium_Brand]
    ,B.[AMS_Competitors_Mainstream_Brand]  
    ,A.[OrderType]
    ,A.[Document No_]
	,A.[DocType]
	,A.[ContractType]
    ,A.[OrderCategory]
    ,A.[ItemCode]
    ,A.[Quantity]
    ,A.[HL]
    ,A.[amount1]
    ,A.[Amount Including VAT]
    ,A.[itm_code]
    ,A.[itm_des]
	,B.[OUTLET_LATITUDE]
	,B.[OUTLET_LONGITUDE]
    ,A.[level1_territory and Name]
    ,A.[level2_territory and Name]
    ,A.[level3_territory and Name]
    ,A.[level4_territory and Name]
	,A.[Order Date]
    ,A.[Posting Date]
	,A.[Posting Description]
    ,A.[Shipment Date]
    ,A.[Due Date]
    ,A.[Document Date]

FROM DIS AS A 
LEFT JOIN MASTER_DATA AS B 
ON CAST(A.Outlet_Code AS INT) = CAST(B.Code AS INT)
)
SELECT DISTINCT * FROM RESULT_TABLE
WHERE Outlet_Code IN (
'71416820',
'71417504',
'78023335',
'71315371',
'78000422',
'78002542',
'71417425',
'78023638',
'71000730',
'71416740',
'79001978',
'71417167',
'78023246',
'78022691',
'71416655',
'71001239',
'71315578',
'71018088',
'71416659',
'78006229',
'78022837',
'71012260',
'71000974',
'71000856',
'78002291',
'71000718',
'77001138',
'78020692',
'71416102',
'78010807',
'77000703',
'78023058',
'71318608',
'71006468',
'71416590',
'71016470',
'78020977',
'77001327',
'78006349',
'78023243',
'71004051',
'77001331',
'71000108',
'79000129',
'71000732',
'78006278',
'71001005',
'71000643',
'71417243',
'71019504',
'71000624',
'71416352',
'71000704',
'71016587',
'71416469',
'71417371',
'71016951',
'78003199',
'71004050',
'71000743',
'71000997',
'71416355',
'71017566',
'71017506',
'71004059',
'71013041',
'78023227',
'71416604',
'71416741',
'71000737',
'78006272',
'78010815',
'71004060',
'78006317',
'71000112',
'71416570',
'78003503',
'78023244',
'71004021',
'78021317',
'79001990',
'77000457',
'71004035',
'78023043',
'71000703',
'71013009',
'71000695',
'78020948',
'78021608',
'78022232',
'78023232',
'78020599',
'78003479',
'73013369',
'78020573',
'78020695',
'78020694',
'73000620',
'73003310',
'79000636',
'78023839',
'73009479',
'78022045',
'73000271',
'78021774',
'78001442',
'78021779',
'73008359',
'78020650',
'78022566',
'78022568',
'78022273',
'73012715',
'78020663',
'71417957',
'71018069',
'78021061',
'71003959',
'71000860',
'71004024',
'78022241',
'78002670',
'78021084',
'71006260',
'73008746',
'73013201',
'78002976',
'73005878',
'73005881',
'73000440',
'71001227',
'71315432',
'71017631',
'71416375',
'71004077',
'78022553',
'71012545',
'71001257',
'79004773',
'78006313',
'71009271',
'71416627',
'71000021',
'78006275',
'78021601',
'78003070',
'79006799',
'71017847',
'71416543',
'71416972',
'78003574',
'71018312',
'71018430',
'71004242',
'78003504',
'78020888',
'78022436',
'78003124',
'78020708',
'79006008',
'71416382',
'78001743',
'71000592',
'78022044',
'78006329',
'71316115',
'73002844',
'73009028',
'73003258',
'73004116',
'73008453',
'73009994',
'78001576',
'78021448',
'78021499',
'78020556',
'78021090',
'79007523',
'78002659',
'73000082',
'73000686',
'71019370',
'79007706',
'71004429',
'79001982',
'71020389',
'79009998',
'79000305',
'78000129',
'79009997',
'71416805',
'78021607',
'78006343',
'71004023',
'79000226',
'71003966',
'78021068',
'79010773',
'71001001',
'71316408',
'78022716',
'79011092',
'79010852',
'71416252',
'79008236',
'77001223',
'71015697',
'73000610',
'73005999',
'78020985',
'77001165',
'78020879',
'71018261',
'78020873',
'79004385',
'71318025',
'71000133',
'78023990',
'78021605',
'71010422',
'71417888',
'71016948',
'71416056',
'79011515',
'78022475',
'77000460',
'71007910',
'77001275',
'79004772',
'78003110',
'78022728',
'79011971',
'79008235',
'71004047',
'78023384',
'79011995',
'71006300',
'78022373',
'71418079',
'78023852',
'79011994',
'79012215',
'77000523',
'78024449',
'79014977',
'79015232',
'79001984',
'79014387',
'71005611',
'78022438',
'71416253',
'71416072',
'71004066',
'79019388',
'79011459',
'75004079',
'79002131',
'74001721',
'74003691',
'74000222',
'74006548',
'75000553',
'78003190',
'74009523',
'75000685',
'74009644',
'75003490',
'75000586',
'75000506',
'75002613',
'78001230',
'74009449',
'74008488',
'74000398',
'74000199',
'74000264',
'78015114',
'75003473',
'75000124',
'75003911',
'75003066',
'75000136',
'75002056',
'75003176',
'79002243',
'75001849',
'79005213',
'75002736',
'78021735',
'79005377',
'74000170',
'78015812',
'75004130',
'79005568',
'74001720',
'78020988',
'78022226',
'75000331',
'75003429',
'75003488',
'79002358',
'75002216',
'75000696',
'75003408',
'75000344',
'73001767',
'79000920',
'78001153',
'73007382',
'78024003',
'79003531',
'73007129',
'79000724',
'78022047',
'73004246',
'73008425',
'73002593',
'78021203',
'73013404',
'73010020',
'73008188',
'78021194',
'73011909',
'73013466',
'79004173',
'73008595',
'78021302',
'78017572',
'78017619',
'73003187',
'78023147',
'77001279',
'73007381',
'73013552',
'73001879',
'78002349',
'73006984',
'73006252',
'73010033',
'73010036',
'78023119',
'78020886',
'73011592',
'78022817',
'78022193',
'78020096',
'73001926',
'73002785',
'73010048',
'73012136',
'79004883',
'79004891',
'73003305',
'73013522',
'78023123',
'79004342',
'73009820',
'78023644',
'79000919',
'78022005',
'78003517',
'78021777',
'73011366',
'73012301',
'77000228',
'78023120',
'77000807',
'73009794',
'73002753',
'73006226',
'78023971',
'73013412',
'79006515',
'73011882',
'73012775',
'79004253',
'78017569',
'73011871',
'78017570',
'73010340',
'78020690',
'78001761',
'79001104',
'79005587',
'77000409',
'79000931',
'77000918',
'73012463',
'79005645',
'77000560',
'79006983',
'78002319',
'73013473',
'79007175',
'79003552',
'73004034',
'73011769',
'78020048',
'73012551',
'78001710',
'73009171',
'73010345',
'73010346',
'73003635',
'78021363',
'79010188',
'73001270',
'73010133',
'73002373',
'73012838',
'79007949',
'79005668',
'79007926',
'79005667',
'79007794',
'79002085',
'79010515',
'79010459',
'79010828',
'79010101',
'73013349',
'77001194',
'78002057',
'78011078',
'78000866',
'73008338',
'73013184',
'78020964',
'78000319',
'79011436',
'79002869',
'73010008',
'73010024',
'73008920',
'73004044',
'79011653',
'78003355',
'78003796',
'78002316',
'73008191',
'73000787',
'73008317',
'79008531',
'79012136',
'73009587',
'78017573',
'79005136',
'73006619',
'79002536',
'79004459',
'79012195',
'73001218',
'73011877',
'73011881',
'78003420',
'72000706',
'78003134',
'76100021',
'76103333',
'76103619',
'76103626',
'76103593',
'71007296',
'78020921',
'76103527',
'71005281',
'71005341',
'76100314',
'76102773',
'76016293',
'72001555',
'76102884',
'72001536',
'76100329',
'78003205',
'78022694',
'72001275',
'76319664',
'76318234',
'71010608',
'71316819',
'76103059',
'71011332',
'71009086',
'71315989',
'76013559',
'76015722',
'79003430',
'79003417',
'76103500',
'76100103',
'72001533',
'76100087',
'72002063',
'76103189',
'76103170',
'78019169',
'76100832',
'72001527',
'72002161',
'78019185',
'79004419',
'79004117',
'71009135',
'71009144',
'76102893',
'78023882',
'78002000',
'76102710',
'79000489',
'72001531',
'78022153',
'76016600',
'78022152',
'71316171',
'76103227',
'79005147',
'79004115',
'78019164',
'79003520',
'72000390',
'78019162',
'76103447',
'78001741',
'76013425',
'76100079',
'76100086',
'72002158',
'76103641',
'76103455',
'76103798',
'79006414',
'78001234',
'76016292',
'79005739',
'71009552',
'76103312',
'79007948',
'72000550',
'72002451',
'76100008',
'76103629',
'79007875',
'76323923',
'78022266',
'76002674',
'79010772',
'79010516',
'79007873',
'71008508',
'72002347',
'78000513',
'72001530',
'79011123',
'72001549',
'78023104',
'79000511',
'78003311',
'72002039',
'76024106',
'76000160',
'78021920',
'76024386',
'79002322',
'78002669',
'79002325',
'79000583',
'79002239',
'78022201',
'78022828',
'78002730',
'78023216',
'79000464',
'76001068',
'76003734',
'76025825',
'79003432',
'79002257',
'78021041',
'79000584',
'79003506',
'78021767',
'79000394',
'78018876',
'78022470',
'78022313',
'78018884',
'76103981',
'79000568',
'78021857',
'79000438',
'78021040',
'78016526',
'78022975',
'78021409',
'78018908',
'79004105',
'78000443',
'76324334',
'79004086',
'78016610',
'79000516',
'79003372',
'79001312',
'79002266',
'78018872',
'76323280',
'79000586',
'78022673',
'76319655',
'72000709',
'78021960',
'78016589',
'76324328',
'79003628',
'76024199',
'79004104',
'79000437',
'76100164',
'72002056',
'76013140',
'78020667',
'79004148',
'72000829',
'78016568',
'72000217',
'76013078',
'76321841',
'79004201',
'79004295',
'76100011',
'78022892',
'78003407',
'79000908',
'78016574',
'78022979',
'79002497',
'76102982',
'76024646',
'78021546',
'79004302',
'76000552',
'76024390',
'76024117',
'78021042',
'72000190',
'78021421',
'76005505',
'76000372',
'78014532',
'78022365',
'79004698',
'79004733',
'72000988',
'79000426',
'79004747',
'78024443',
'79004606',
'76320649',
'78016606',
'72002385',
'78018914',
'79000525',
'79002258',
'76318088',
'76323398',
'76319807',
'78016599',
'76321348',
'76006417',
'79005138',
'76019007',
'79004294',
'76318658',
'79004819',
'79006412',
'78002657',
'78016557',
'78016685',
'76318641',
'72002068',
'76016393',
'79004121',
'79004328',
'79000582',
'79006006',
'79006052',
'78021765',
'78022672',
'78022482',
'76322440',
'76100759',
'79000575',
'79000314',
'79006411',
'79004964',
'79006764',
'79007553',
'79007820',
'72000724',
'76003086',
'79004122',
'79002123',
'78023190',
'76006224',
'76022550',
'79007161',
'78021054',
'79006978',
'76024539',
'79000624',
'76024658',
'79005785',
'79003415',
'79007410',
'78016531',
'76323245',
'79007189',
'79007408',
'72001888',
'76100805',
'78018887',
'79002265',
'72002055',
'79009261',
'76014582',
'79004701',
'79010323',
'76025715',
'78002123',
'79004803',
'79005099',
'79000590',
'79000580',
'79005670',
'76013543',
'72001036',
'79000573',
'78020725',
'78023134',
'79011674',
'79007163',
'76024197',
'76324028',
'72000147',
'79011965',
'79010779',
'79011273',
'79011540',
'79012216',
'79011275',
'79010160',
'79006915',
'79000587',
'79003529',
'79011790',
'79011447',
'79000297',
'77001241',
'77001329',
'71019726',
'78009745',
'71020269',
'78023842',
'71004625',
'78022124',
'79003604',
'78023993',
'71017053',
'77001302',
'71415737',
'78022518',
'78023255',
'78021843',
'79000478',
'71018665',
'71007139',
'71002096',
'78009748',
'71020506',
'78009744',
'78003307',
'78021058',
'71005230',
'71316970',
'71316751',
'78000020',
'71014529',
'79000520',
'71017741',
'78020550',
'71017571',
'71020726',
'71416613',
'71316990',
'78001704',
'71015087',
'71018424',
'78003201',
'71317855',
'71316443',
'71316464',
'71316765',
'71417137',
'78000015',
'71020118',
'71315436',
'71005837',
'71017547',
'78019587',
'71005008',
'71013764',
'71318604',
'71007016',
'71317254',
'71004785',
'71316893',
'77000372',
'78004148',
'71020405',
'78009917',
'71018725',
'79005956',
'78023878',
'78020960',
'77000270',
'77000205',
'71018850',
'71416986',
'71006713',
'79006110',
'71416498',
'71005088',
'71318212',
'79008049',
'71004634',
'77000150',
'71004816',
'71416189',
'78007140',
'71005004',
'71005031',
'71318787',
'71020761',
'79006108',
'77000595',
'79010756',
'78009759',
'79010755',
'79010754',
'79010841',
'71019624',
'78009790',
'79011959',
'78002013',
'71003486',
'71416896',
'71317063',
'71316638',
'71012781',
'71318710',
'71315980',
'71316885',
'71006043',
'78022497',
'71002398',
'78009180',
'78001168',
'78021195',
'79000468',
'71011626',
'71007846',
'79002188',
'78003036',
'79001522',
'71000853',
'71006104',
'78022587',
'78023167',
'71314801',
'71003348',
'71015818',
'71317379',
'78022305',
'71003529',
'79002370',
'78003463',
'71316287',
'71014701',
'78005954',
'71002412',
'71004986',
'78021011',
'78006465',
'78023725',
'71011367',
'71017392',
'71015798',
'71016429',
'71003036',
'71317509',
'71316982',
'71317408',
'78000006',
'71416377',
'78020891',
'71416954',
'78002274',
'78000618',
'71003194',
'78022714',
'71316106',
'78003047',
'78023763',
'79001635',
'71006645',
'71012423',
'71003558',
'78002080',
'78020902',
'71018080',
'78001996',
'71009351',
'71010420',
'71417912',
'78002215',
'71002341',
'71002672',
'78003002',
'78002179',
'71416105',
'78009236',
'71317122',
'71418075',
'79000102',
'78020900',
'78022511',
'71416537',
'71317774',
'77001257',
'78022076',
'78003238',
'71416140',
'71003730',
'78009287',
'78008879',
'71318610',
'71007924',
'71003265',
'71417008',
'71002285',
'78002222',
'71003323',
'71318590',
'71003325',
'78001821',
'71417459',
'78005915',
'71317106',
'78022320',
'78021227',
'78008853',
'71003339',
'78008750',
'71003536',
'78023034',
'71317111',
'71003315',
'71317135',
'79000229',
'79002371',
'78021942',
'71316812',
'78022340',
'78005896',
'78022243',
'79004180',
'71006643',
'71002390',
'78009103',
'78021555',
'71316076',
'71001651',
'71005516',
'78021392',
'78021976',
'77000701',
'78007472',
'71002392',
'71006457',
'71416240',
'71316724',
'78008684',
'78008932',
'78008901',
'78020885',
'78006082',
'78005979',
'78023611',
'78023883',
'71317239',
'78023897',
'78003430',
'79002252',
'78021554',
'78009083',
'71317301',
'71316767',
'71007692',
'71318854',
'78020600',
'71316544',
'71008011',
'71316909',
'78009195',
'78009197',
'78020696',
'71318690',
'71018381',
'79000661',
'71013259',
'78008754',
'71002938',
'78009210',
'71003059',
'71011483',
'78022189',
'78008881',
'71003815',
'71002118',
'71002355',
'71009202',
'78022270',
'78003090',
'71416952',
'71317133',
'71007036',
'78022721',
'71318370',
'71011899',
'71003842',
'78005839',
'71316361',
'71010502',
'71318481',
'71019182',
'71005804',
'71417009',
'71007988',
'71010500',
'71417259',
'71416807',
'78021841',
'71000283',
'71417257',
'71003240',
'71016467',
'71417127',
'78003243',
'78009099',
'78021604',
'71415998',
'71005831',
'78020685',
'71417427',
'71009709',
'78022304',
'71418016',
'71002752',
'79004470',
'71002340',
'71001401',
'71417389',
'79004348',
'78008877',
'71417072',
'71416976',
'71006063',
'78009045',
'78008825',
'71010383',
'71316359',
'71012022',
'78023151',
'71002709',
'71019192',
'71001327',
'78008819',
'78000582',
'71001771',
'78008730',
'71318531',
'79004471',
'71018208',
'71005682',
'78022655',
'71003480',
'78001946',
'71002295',
'79004467',
'71003839',
'71317607',
'78009011',
'71003048',
'78022777',
'78009146',
'71316103',
'71014075',
'71316545',
'71005639',
'78020997',
'71003492',
'71415991',
'71003306',
'71005678',
'71417405',
'78003194',
'71316864',
'78023033',
'71316903',
'78022310',
'71002812',
'71415962',
'78019410',
'71317160',
'71003487',
'78003418',
'71317695',
'71316997',
'71317107',
'79005272',
'78021135',
'71001776',
'78006004',
'71417014',
'78020923',
'78001945',
'71002942',
'78021480',
'71003482',
'78005946',
'78022722',
'79002190',
'71316946',
'71000202',
'71318707',
'71018526',
'79005473',
'71415960',
'71416139',
'78002600',
'78021859',
'71317702',
'71010217',
'71417472',
'71007049',
'71418018',
'71416138',
'78005978',
'78009010',
'71001987',
'71003368',
'79005840',
'78021944',
'79000704',
'78006460',
'79005475',
'71001650',
'71015065',
'71416339',
'71005714',
'71001274',
'71018274',
'71008730',
'78023269',
'78005849',
'71317862',
'78008749',
'71317118',
'71317116',
'71010330',
'71002882',
'79006970',
'71008563',
'78008735',
'78008736',
'71006124',
'79007411',
'79005943',
'71018503',
'78008910',
'79005946',
'79007703',
'71315797',
'71002649',
'71016202',
'78006000',
'71015966',
'71007482',
'78008903',
'71018082',
'71416934',
'78023598',
'71000171',
'78021106',
'71006359',
'78023601',
'78009241',
'71009739',
'78001993',
'78006108',
'71012023',
'78001278',
'71316045',
'79008241',
'79006971',
'71316158',
'78002339',
'71416592',
'71417434',
'79007819',
'78023729',
'79008240',
'78021044',
'78002825',
'71417453',
'79010261',
'78022003',
'71005517',
'78020843',
'71003748',
'71318359',
'79010185',
'79007982',
'78001947',
'71002367',
'71006173',
'78005939',
'71417911',
'78020834',
'78009016',
'79000547',
'78001971',
'71005231',
'78008587',
'79007979',
'79007983',
'78006461',
'71000247',
'79011094',
'78021435',
'79011713',
'79005838',
'79006972',
'79008233',
'79011468',
'79011431',
'79011471',
'71417884',
'79011448',
'71417380',
'71007874',
'71003553',
'78022654',
'71316773',
'78008921',
'79010134',
'71007927',
'79011479',
'71416174',
'71316728',
'71012174',
'71316367',
'71003002',
'71002962',
'79011090',
'71002366',
'71001979',
'79011685',
'79008230',
'71417908',
'71006623',
'78021979',
'78003512',
'71416367',
'71316884',
'79011912',
'78022228',
'71417381',
'71002045',
'78001693',
'78021994',
'79011690',
'79008232',
'71001489',
'79011665',
'71417677',
'78002251',
'78003510',
'78001982',
'71002413',
'79007482',
'71316098',
'71002884',
'71317185',
'79011494',
'79011938',
'79011762',
'79007830',
'79011473',
'78021347',
'78006451',
'79011688',
'79012117',
'79014498',
'79011972',
'79011980',
'79011992',
'78008974',
'79007818',
'71315898',
'78005864',
'78019726',
'76023366',
'78022370',
'78013184',
'74006519',
'76020338',
'74000600',
'78001951',
'74009637',
'74007293',
'78014215',
'74000450',
'79003522',
'76020241',
'76002441',
'74008045',
'74001015',
'74007511',
'76002106',
'76002239',
'76001769',
'74007128',
'74002373',
'74009609',
'76008140',
'78022339',
'79000578',
'78022405',
'74000645',
'74008514',
'74009640',
'76023310',
'76004557',
'76002225',
'79003434',
'74004411',
'76000672',
'76018509',
'78022597',
'76018937',
'76005081',
'76002446',
'78022570',
'74005241',
'78021964',
'74005849',
'78014347',
'76000630',
'79005841',
'76025148',
'78020816',
'76025784',
'78014265',
'76024108',
'78024049',
'76025851',
'78021329',
'78013688',
'78022506',
'74002467',
'78012059',
'78000342',
'79004166',
'74002101',
'79005578',
'74000595',
'74000665',
'74002760',
'74002111',
'74008878',
'78003735',
'78003599',
'74009420',
'79004684',
'74006628',
'74000663',
'78011472',
'79003263',
'74008559',
'74006164',
'74009656',
'78001715',
'78011480',
'79007477',
'74003559',
'74005865',
'74007491',
'78011754',
'74001237',
'79010844',
'79005848',
'79002510',
'76021414',
'74008835',
'76002299',
'76005078',
'78022505',
'79008426',
'79011044',
'74001570'
)